<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="zju.edu.als.dao.PressureDao">
    
    <sql  id="PressureDataColumn">
    id,
    surgeryNo,
    timestamp,
    inBloodPressure,
    plasmaInletPressure,
    arterialPressure,
    venousPressure,
    plasmaPressure,
    transmembranePressure
    </sql>
    <resultMap id="PressureData" type="zju.edu.als.domain.data.PressureData" >
        <result column="id" property="id" jdbcType="BIGINT"/>
        <result column="surgeryNo" property="surgeryNo" jdbcType="VARCHAR" />
        <result column="timestamp" property="timestamp" jdbcType="BIGINT" />
        <result column="inBloodPressure" property="inBloodPressure" jdbcType="INTEGER" />
        <result column="plasmaInletPressure" property="plasmaInletPressure" jdbcType="INTEGER" />
        <result column="arterialPressure" property="arterialPressure" jdbcType="INTEGER" />
        <result column="venousPressure" property="venousPressure" jdbcType="INTEGER" />
        <result column="plasmaPressure" property="plasmaPressure" jdbcType="INTEGER" />
        <result column="transmembranePressure" property="transmembranePressure" jdbcType="INTEGER" />
    </resultMap>
    <insert id="insertPressureData" parameterType="zju.edu.als.domain.data.PressureData">
        INSERT INTO
        pressureData(
          surgeryNo,
          timestamp,
          inBloodPressure,
          plasmaInletPressure,
          arterialPressure,
          venousPressure,
          plasmaPressure,
          transmembranePressure
        )
        VALUE
        (#{pressureData.surgeryNo} ,
        #{pressureData.timestamp},
        #{pressureData.inBloodPressure},
        #{pressureData.plasmaInletPressure},
        #{pressureData.arterialPressure},
        #{pressureData.venousPressure},
        #{pressureData.plasmaPressure},
        #{pressureData.transmembranePressure}
        )
    </insert>

    <insert id="batchInsertPressureData" parameterType="java.util.List">
        INSERT INTO
        pressureData(
        surgeryNo,
        timestamp,
        inBloodPressure,
        plasmaInletPressure,
        arterialPressure,
        venousPressure,
        plasmaPressure,
        transmembranePressure
        )
        VALUES
        <foreach collection="pressureDataList" item="pressureData" index="index" separator=",">
            (#{pressureData.surgeryNo} ,
            #{pressureData.timestamp},
            #{pressureData.inBloodPressure},
            #{pressureData.plasmaInletPressure},
            #{pressureData.arterialPressure},
            #{pressureData.venousPressure},
            #{pressureData.plasmaPressure},
            #{pressureData.transmembranePressure}
            )
        </foreach>
    </insert>
    <select id="selectPressureDataBySurgeryNo" parameterType="java.lang.String" resultMap="PressureData">
        SELECT
        <include refid="PressureDataColumn"/>
        FROM
        pressureData
        WHERE
        surgeryNo = #{surgeryNo}
        ORDER BY
        timestamp
    </select>
    <select id="selectPressureDataBySurgeryNoWithTimeRange" parameterType="java.util.Map" resultMap="PressureData">
        SELECT
        <include refid="PressureDataColumn"/>
        FROM
        pressureData
        WHERE
        surgeryNo = #{surgeryNo}
        AND
        timestamp &gt; #{beginTime}
        AND
        timestamp &lt; #{endTime}
        ORDER BY
        timestamp
    </select>
</mapper>